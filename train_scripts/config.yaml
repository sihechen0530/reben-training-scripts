job:
  name: bigearthnet-ft
  # partition/queue 名：有的集群叫 partition，有的叫 qos，按需删改
  partition: gpu-interactive
  qos: normal          # 如无用，删掉即可
  account: zhou.lihan   # 若集群要求记账账号
  time: "02:00:00"     # HH:MM:SS
  nodes: 1
  gres: "gpu:v100-sxm2:1"     # GPU 资源规格（匹配你的 srun 命令）
  cpus_per_task: 8
  mem: "32G"
  mail_user: "you@university.edu"
  mail_type: "END,FAIL"        # 可选：BEGIN, END, FAIL, REQUEUE, ALL
  chdir: "/home/zhou.lihan/reben-training-scripts/scripts"   # 作业工作目录
  output_dir: "../logs"           # slurm 日志目录（相对 chdir）

env:
  # 训练脚本所需的环境变量（可选）
  OMP_NUM_THREADS: 8
  TOKENIZERS_PARALLELISM: "false"
  # HF_TOKEN: ""  # Required for DINOv3 models (gated models on HuggingFace)

data:
  # BigEarthNet v2.0 数据集路径配置
  benv2_data_dir: "/scratch/chen.sihe1"

train:
  script: "train_BigEarthNetv2_0.py"
  use_multimodal: false        # Set true to switch to train_multimodal.py
  multimodal_script: "train_multimodal.py"
  python: "python"   # 或 "python3"
  # 传给 train_BigEarthNetv2_0.py 的参数（会转换为 --k v）
  args:
    architecture: "dinov3-b"
    bandconfig: "rgb"       # # all, s2, s1, rgb, all_full, s2_full, s1_full
    bs: 32                 # batch size (注意：参数名是 bs 不是 batch_size)
    epochs: 20             # 短测试：10 epochs
    lr: 0.001
    seed: 42
    workers: 8
    drop_rate: 0.15
    drop_path_rate: 0.15
    warmup: 1000
    use_wandb: false
    upload_to_hub: false
    linear_probe: true  # Uncomment for DINOv3 linear probing
    head_type: "mlp"
    head_mlp_dims: "1024,512"
    head_dropout: 0.2
    # hf_entity: "your-hf-entity"  # Required if upload_to_hub is true
    # resume_from: "best"  # or path to checkpoint - 注释掉从头开始训练
    config: "../train_scripts/config.yaml"  # Path to this config for data directory
  # 单独给多模态训练脚本的默认参数，只有 use_multimodal: true 时才会被使用
  multimodal_args:
    seed: 42
    lr: 0.001
    epochs: 20
    bs: 32
    drop_rate: 0.15
    warmup: 1000
    workers: 8
    use_wandb: false
    dinov3_hidden_size: 768   # 384/768/1024/1536 -> s/b/l/g
    dinov3_pretrained: true
    dinov3_freeze: false
    dinov3_lr: 0.0001
    resnet_pretrained: true
    resnet_freeze: false
    resnet_lr: 0.0001
    fusion_type: "concat"
    classifier_type: "linear"
    use_s1: false
    config: "../train_scripts/config.yaml"

  # 作业数组（超参搜索）——任选一种：
  sweep:
    # 方式1：笛卡尔积网格（submit.py 自动展开）
    grid:
      lr: [0.001, 0.0003]
      bs: [32, 64]        # 注意这里也要用 bs
      seed: [42, 123]
    # 方式2：从文件读取 N 行配置（与数组索引对应）
    # list_file: "sweeps.txt"
